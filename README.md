# Movie App アーキテクチャ完全ガイド

## 公開URL

[https://movie-app-frontend.vercel.app/](https://movie-app-frontend.vercel.app/)

---

## 1. プロジェクトのビジョン

### 「観る・知る・深掘りする」体験の統合

現代の映画鑑賞体験は、「情報の分断」という課題を抱えています。予告編、最新ニュース、配信状況、鑑賞後の考察記事。これらは通常、別々のプラットフォームで検索する必要があります。

本プロジェクトは、**「一つの作品を軸に、あらゆる情報を繋ぐ」**ことを目的としたメディア統合プラットフォームです。BFF（Backend For Frontend）層で複数の外部ソース（映画データベース、ニュースサイト、検索エンジン）を統合・再構成し、ユーザーに一貫したコンテクストを提供します。

---

## 2. 主な機能

本アプリケーションは、単なるカタログサイトを超えた「映画体験のハブ」として以下の機能を提供します。

- **多角的な映画詳細情報:** 基本データに加え、予告編、配信中のプラットフォーム情報を集約。
- **最新ニュース連携:** 国内大手映画ニュースサイトから、作品に関連する最新記事を自動収集・表示。
- **深掘り考察検索:** Google検索エンジンと連携し、作品の理解を深めるための高品質な考察・解説記事を提案。
- **リッチな探索UI:** カテゴリ別スライダーやレスポンシブなタイルビューによる、直感的で没入感のある作品探し。
- **ウォッチリスト:** 気になる作品を保存し、いつでもアクセス可能（ブラウザ保存）。

---

## 3. 技術スタック

プロジェクト全体で TypeScript を採用し、型安全かつモダンなライブラリで構成されています。

### フロントエンド

- **コア:** React (Vite)
- **状態管理/データ取得:** TanStack Query (React Query)
- **スタイリング:** Tailwind CSS
- **アニメーション/UI:** Framer Motion, Swiper.js, Lucide React

### バックエンド (BFF)

- **実行環境:** Node.js (TypeScript)
- **フレームワーク:** Express
- **データ収集:** Axios, Cheerio (スクレイピング)

### アーキテクチャ・ツール

- **構成:** npm workspaces (Monorepo), BFF Pattern, Clean Architecture
- **共通資産:** `shared` パッケージによる型定義の共有

---

## 4. コア・アーキテクチャ原則

### 4-1. Monorepo (npm workspaces)

フロントエンド、バックエンド、および共通資産を一括管理します。特に `shared/` パッケージを介した型共有により、APIの変更をコンパイルレベルでフロントエンドに同期させます。

### 4-2. Backend: Clean Architecture

ビジネスロジックを外部依存（APIやスクレイピング）から隔離。Repository Pattern により、外部サイトの構造変化がコアロジックを汚染しない設計を徹底しています。

### 4-3. Frontend: Feature-Sliced Design (FSD)

「機能（Feature）」単位でコードをパッケージ化。コンポーネント、Hooks、APIロジックを近接配置することで、機能拡張時の認知負荷を最小限に抑えています。

---

## 5. ディレクトリ構造と責務の詳細

```text
.
├── api/                # バックエンド (Node.js/Express)
│   └── src/
│       ├── domain/     # 【最内部】エンティティ、モデル、リポジトリのインターフェース
│       ├── application/# 【ユースケース層】業務ロジック、データ加工のシナリオ
│       ├── infrastructure/ # 【外部接続層】APIクライアント、リポジトリ実装、キャッシュ
│       └── presentation/ # 【インターフェース層】コントローラー、ルーティング、DIコンテナ
├── frontend/           # フロントエンド (React/Vite)
│   └── src/
│       ├── features/   # 機能単位のパッケージ（UI、Hooks、ロジックの内包）
│       ├── components/ # 共通UIコンポーネント
│       └── services/   # API通信の基盤定義
├── shared/             # 共通資産
│   └── types/          # フロント・バック間で共有するTypeScript型定義
└── docs/               # プロジェクトドキュメント
```

---

## 6. データの流れと変換プロセス

1.  **Request:** フロントエンドの `features` 層が API を呼び出し。
2.  **Accept:** `presentation` 層がリクエストを解釈し、ユースケースへ。
3.  **Fetch:** `infrastructure` 層が外部ソースを取得。
4.  **Transform:** インフラ層で外部データを **Domain Model** へ変換。
5.  **Enrich:** `application` 層で複数モデルを結合し、**Response DTO** を生成。
6.  **Consume:** フロントエンドが `shared` の型に従ってデータを表示。

---

## 7. 設計上の重要ポイントと決定事項

### 7-1. 多層キャッシュ戦略

- **Server-side:** 外部APIのレートリミット回避と高速化のため、インフラ層にキャッシュを実装。
- **Client-side:** React Query によるキャッシュで、シームレスな画面遷移を実現。

### 7-2. 依存性の注入 (DI)

バックエンドではDIを活用。各層をインターフェースで結合することで、テスト容易性と部品の交換可能性を担保しています。

---

## 8. 今後の展望

- **永続キャッシュ:** Redis 等の導入による、サーバーレス環境でのキャッシュ効率の最大化。
- **認証とパーソナライズ:** アカウント機能による、より個々の好みに最適化されたレコメンド機能の実装。
